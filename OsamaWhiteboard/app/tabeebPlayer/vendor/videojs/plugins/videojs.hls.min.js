/*! videojs-contrib-hls - v0.16.0 - 2015-05-21
* Copyright (c) 2015 Brightcove; Licensed  */
!function(a,b,c,d){"use strict";var e,f,g,h=1.1,i=500;f=function(a){return a.retries&&a.retries>=2},b.Hls=b.Flash.extend({init:function(a,c,d){var e=c.source,f=a.options();a.hls=this,delete c.source,c.swf=f.flash.swf,b.Flash.call(this,a,c,d),c.source=e,this.bytesReceived=0,this.currentTime=b.Hls.prototype.currentTime,this.setCurrentTime=b.Hls.prototype.setCurrentTime,this.segmentBuffer_=[],this.startCheckingBuffer_(),b.Hls.prototype.src.call(this,c.source&&c.source.src)}}),b.options.techOrder.unshift("hls"),b.Hls.GOAL_BUFFER_LENGTH=30,b.Hls.prototype.src=function(c){var f,g,h,i=this,j=this.player(),k=j.options().hls||{};c&&(this.src_&&this.resetSrc_(),this.src_=c,f=new b.MediaSource,h={src:b.URL.createObjectURL(f),type:"video/flv"},this.mediaSource=f,this.segmentBuffer_=[],this.segmentParser_=new b.Hls.SegmentParser,function(){var c,d=i.segmentParser_.metadataStream;i.player().addTextTrack&&d.on("data",function(e){var f,g,h,j,k;if(!c)for(c=i.player().addTextTrack("metadata","Timed Metadata"),c.inBandMetadataTrackDispatchType=b.Hls.SegmentParser.STREAM_TYPES.metadata.toString(16).toUpperCase(),f=0;f<d.descriptor.length;f++)k=("00"+d.descriptor[f].toString(16).toUpperCase()).slice(-2),c.inBandMetadataTrackDispatchType+=k;for(f=0;f<e.frames.length;f++)h=e.frames[f],j=e.pts/1e3,g=new a.VTTCue(j,j,h.value||h.url||""),g.frame=h,c.addCue(g)})}(),this.mediaSource.addEventListener("sourceopen",b.bind(this,this.handleSourceOpen)),this.playlists&&this.playlists.dispose(),this.mediaIndex=0,this.playlists=new b.Hls.PlaylistLoader(this.src_,k.withCredentials),this.playlists.on("loadedmetadata",b.bind(this,function(){var a,c,e,f,h,i,k,l;k=function(){this.fillBuffer(),j.trigger("loadedmetadata")},g=this.playlists.media(),this.bandwidth===d&&this.setBandwidth({bandwidth:5*this.playlists.bandwidth}),this.duration()===1/0&&0===this.mediaIndex&&(this.mediaIndex=b.Hls.getMediaIndexForLive_(g)),a=this.selectPlaylist(),e=g.attributes&&g.attributes.BANDWIDTH||0,f=a.attributes&&a.attributes.BANDWIDTH||0,h=g.segments&&g.segments[this.mediaIndex].duration||g.targetDuration,i=h*f/this.bandwidth,i||(i=1/0),l=10,f>e&&l>=i?(this.playlists.media(a),c=b.bind(this,function(){k.call(this),this.playlists.off("loadedplaylist",c)}),this.playlists.on("loadedplaylist",c)):k.call(this)})),this.playlists.on("error",b.bind(this,function(){j.error(this.playlists.error)})),this.playlists.on("loadedplaylist",b.bind(this,function(){var a=this.playlists.media();a&&(this.updateDuration(this.playlists.media()),this.mediaIndex=b.Hls.translateMediaIndex(this.mediaIndex,g,a),g=a,this.fetchKeys_())})),this.playlists.on("mediachange",b.bind(this,function(){e&&this.cancelKeyXhr(),j.trigger("mediachange")})),this.player().ready(function(){i.el()&&i.el().vjs_src(h.src)}))},b.Hls.getMediaIndexForLive_=function(a){if(!a.segments)return 0;for(var b=a.segments.length,c=0,d=3*(a.targetDuration||10);d>c&&b>0;)c+=a.segments[b-1].duration,b--;return b},b.Hls.prototype.handleSourceOpen=function(){var a=this.player(),b=this.mediaSource.addSourceBuffer('video/flv; codecs="vp6,aac"');this.sourceBuffer=b,b.appendBuffer(this.segmentParser_.getFlvHeader()),a.options().autoplay&&a.play()},b.Hls.prototype.play=function(){return this.ended()&&(this.mediaIndex=0),this.duration()===1/0&&this.playlists.media()&&!this.player().hasClass("vjs-has-started")&&(this.mediaIndex=b.Hls.getMediaIndexForLive_(this.playlists.media()),this.setCurrentTime(this.getCurrentTimeByMediaIndex_(this.playlists.media(),this.mediaIndex))),b.Flash.prototype.play.apply(this,arguments)},b.Hls.prototype.currentTime=function(){return this.lastSeekedTime_?this.lastSeekedTime_:this.el()&&this.el().vjs_getProperty?this.el().vjs_getProperty("currentTime"):0},b.Hls.prototype.setCurrentTime=function(a){return this.playlists&&this.playlists.media()?(this.lastSeekedTime_=a,this.mediaIndex=b.Hls.getMediaIndexByTime(this.playlists.media(),a),this.sourceBuffer.abort(),this.cancelSegmentXhr(),e&&(e.aborted=!0,this.cancelKeyXhr()),this.segmentBuffer_=[],void this.fillBuffer(1e3*a)):0},b.Hls.prototype.duration=function(){var a=this.playlists;return a?b.Hls.getPlaylistTotalDuration(a.media()):0},b.Hls.prototype.updateDuration=function(a){var c=this.player(),d=c.duration(),e=b.Hls.getPlaylistTotalDuration(a);d!==e&&c.trigger("durationchange")},b.Hls.prototype.resetSrc_=function(){this.cancelSegmentXhr(),this.cancelKeyXhr(),this.sourceBuffer&&this.sourceBuffer.abort()},b.Hls.prototype.cancelKeyXhr=function(){e&&(e.onreadystatechange=null,e.abort(),e=null)},b.Hls.prototype.cancelSegmentXhr=function(){this.segmentXhr_&&(this.segmentXhr_.onreadystatechange=null,this.segmentXhr_.abort(),this.segmentXhr_=null)},b.Hls.prototype.dispose=function(){this.stopCheckingBuffer_(),this.playlists&&this.playlists.dispose(),this.resetSrc_(),b.Flash.prototype.dispose.call(this)},b.Hls.prototype.selectPlaylist=function(){var a,c,d,e,f,g,i=this.player(),j=this.playlists.master.playlists.slice(),k=[],l=j.length;for(j.sort(b.Hls.comparePlaylistBandwidth);l--;)c=j[l],c.attributes&&c.attributes.BANDWIDTH&&(a=c.attributes.BANDWIDTH*h,a<i.hls.bandwidth&&(k.push(c),e||(e=c)));for(l=k.length,k.sort(b.Hls.comparePlaylistResolution),c=null;l--;)if(d=c,c=k[l],c.attributes&&c.attributes.RESOLUTION&&c.attributes.RESOLUTION.width&&c.attributes.RESOLUTION.height){if(c.attributes.RESOLUTION.width===i.width()&&c.attributes.RESOLUTION.height===i.height()){f=null,g=c;break}if(c.attributes.RESOLUTION.width<i.width()&&c.attributes.RESOLUTION.height<i.height()){d&&d.attributes&&d.attributes.RESOLUTION&&d.attributes.RESOLUTION.width&&d.attributes.RESOLUTION.height&&(f=d),g=c;break}}return f||g||e||j[0]},b.Hls.prototype.checkBuffer_=function(){this.checkBufferTimeout_&&(a.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null),this.fillBuffer(),this.drainBuffer(),this.checkBufferTimeout_=a.setTimeout(b.bind(this,this.checkBuffer_),i)},b.Hls.prototype.startCheckingBuffer_=function(){this.player().on("waiting",b.bind(this,this.drainBuffer)),this.checkBuffer_()},b.Hls.prototype.stopCheckingBuffer_=function(){a.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null,this.player().off("waiting",this.drainBuffer)},b.Hls.prototype.fillBuffer=function(a){var c,d,e=this.player(),f=e.buffered(),g=0;(e.hasClass("vjs-has-started")||"none"!==e.options().preload)&&e.currentSrc()&&this.playlists&&(this.segmentXhr_||"HAVE_NOTHING"!==this.playlists.state&&this.playlists.media()&&this.playlists.media().segments&&(c=this.playlists.media().segments[this.mediaIndex],c&&(f&&(g=e.buffered().end(0)-e.currentTime()),"number"!=typeof a&&g>=b.Hls.GOAL_BUFFER_LENGTH||(d=this.playlistUriToUrl(c.uri),this.loadSegment(d,a)))))},b.Hls.prototype.playlistUriToUrl=function(a){var b;return b=this.playlists.media().uri===this.src_?g(this.src_,a):g(g(this.src_,this.playlists.media().uri||""),a)},b.Hls.prototype.setBandwidth=function(a){var b=this;b.segmentXhrTime=a.roundTripTime,b.bandwidth=a.bandwidth,b.bytesReceived+=a.bytesReceived||0,b.trigger("bandwidthupdate")},b.Hls.prototype.loadSegment=function(a,c){var d=this,e=this.player(),f=e.options().hls||{};this.segmentXhr_=b.Hls.xhr({url:a,responseType:"arraybuffer",withCredentials:f.withCredentials},function(a,b){var f;return d.segmentXhr_=null,a?"timeout"===a?(d.bandwidth=1,d.playlists.media(d.selectPlaylist())):(d.error={status:this.status,message:"HLS segment request error at URL: "+b,code:this.status>=500?4:2},void d.mediaIndex++):void(this.response&&(d.setBandwidth(this),f={mediaIndex:d.mediaIndex,playlist:d.playlists.media(),offset:c,bytes:null,encryptedBytes:null,decrypter:null},f.playlist.segments[f.mediaIndex].key?f.encryptedBytes=new Uint8Array(this.response):f.bytes=new Uint8Array(this.response),d.segmentBuffer_.push(f),e.trigger("progress"),d.drainBuffer(),d.mediaIndex++,d.playlists.media(d.selectPlaylist())))})},b.Hls.prototype.drainBuffer=function(a){var c,d,e,g,h,i,j,k,l,m,n=0,o=0,p=this.segmentBuffer_;if(p.length&&this.sourceBuffer&&!this.sourceBuffer.updating){if(c=p[0],d=c.mediaIndex,e=c.playlist,g=c.offset,i=c.bytes,j=e.segments[d],j.key&&!i)return f(j.key)?p.shift():j.key.bytes?c.decrypter?void 0:(l=j.key.iv||new Uint32Array([0,0,0,d+e.mediaSequence]),k=new b.Hls.Decrypter(c.encryptedBytes,j.key.bytes,l,function(a,b){c.bytes=b}),void(c.decrypter=k)):this.fetchKeys_();for(a=a||{},o=1e3*b.Hls.getPlaylistDuration(e,0,d),this.segmentParser_.parseSegmentBinaryData(i),this.segmentParser_.flushTags(),h=[];this.segmentParser_.tagsAvailable();)h.push(this.segmentParser_.getNextTag());if(h.length>0&&(j.preciseDuration=.001*b.Hls.FlvTag.durationFromTags(h)),this.updateDuration(this.playlists.media()),"number"==typeof g){for(m=g-o+h[0].pts;h[n].pts<m;)n++;this.el().vjs_setProperty("currentTime",.001*(h[n].pts-h[0].pts+o)),h=h.slice(n),this.lastSeekedTime_=null}j.discontinuity&&h.length&&this.el().vjs_discontinuity(),function(){var a,b,c=0;for(n=0;n<h.length;n++)c+=h[n].bytes.byteLength;for(b=new Uint8Array(c),n=0,a=0;n<h.length;n++)b.set(h[n].bytes,a),a+=h[n].bytes.byteLength;this.sourceBuffer.appendBuffer(b)}.call(this),p.shift(),this.duration()!==1/0&&d+1===e.segments.length&&this.mediaSource.endOfStream()}},b.Hls.prototype.fetchKeys_=function(){var a,c,d,g,h,i,j,k;if(!e&&this.segmentBuffer_.length)for(d=this,g=this.player(),h=g.options().hls||{},k=function(a){return function(b){return e=null,b||!this.response||16!==this.response.byteLength?(a.retries=a.retries||0,a.retries++,void(this.aborted||d.fetchKeys_())):(j=new DataView(this.response),a.bytes=new Uint32Array([j.getUint32(0),j.getUint32(4),j.getUint32(8),j.getUint32(12)]),void d.checkBuffer_())}},a=0;a<d.segmentBuffer_.length;a++)if(i=d.segmentBuffer_[a].playlist.segments[d.segmentBuffer_[a].mediaIndex],c=i.key,c&&!c.bytes&&!f(c)){e=b.Hls.xhr({url:this.playlistUriToUrl(c.uri),responseType:"arraybuffer",withCredentials:h.withCredentials},k(c));break}},b.Hls.supportsNativeHls=function(){var a,d,e=c.createElement("video");return b.Html5.isSupported()?(a=e.canPlayType("application/x-mpegURL"),d=e.canPlayType("application/vnd.apple.mpegURL"),/probably|maybe/.test(a)||/probably|maybe/.test(d)):!1}(),b.Hls.isSupported=function(){return!b.Hls.supportsNativeHls&&b.Flash.isSupported()&&b.MediaSource&&a.Uint8Array},b.Hls.canPlaySource=function(a){var b=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;return b.test(a.type)},b.Hls.getPlaylistDuration=function(a,b,c){var e,f,g=0;for(b=b||0,c=c!==d?c:(a.segments||[]).length,f=c-1;f>=b;f--)e=a.segments[f],g+=e.preciseDuration||e.duration||a.targetDuration||0;return g},b.Hls.getPlaylistTotalDuration=function(c){return c?c.totalDuration?c.totalDuration:c.endList?b.Hls.getPlaylistDuration(c):a.Infinity:0},b.Hls.translateMediaIndex=function(a,c,d){var e;return 0===a?0:d&&d.segments?(e=a+(c.mediaSequence-d.mediaSequence),e>=d.segments.length||0>e?b.Hls.getMediaIndexForLive_(d)+1:e):0},b.Hls.getMediaIndexByTime=function(a,b){var c,d,e,f;for(e=[],c=0;c<a.segments.length;c++)f={},f.start=0===c?0:e[c-1].end,f.end=f.start+a.segments[c].duration,e.push(f);for(d=0;d<e.length;d++)if(b>=e[d].start&&b<e[d].end)return d;return-1},b.Hls.prototype.getCurrentTimeByMediaIndex_=function(a,b){var c,d=0;if(!a.segments||0===b)return 0;for(c=0;b>c;c++)d+=a.segments[c].duration;return d},b.Hls.comparePlaylistBandwidth=function(b,c){var d,e;return b.attributes&&b.attributes.BANDWIDTH&&(d=b.attributes.BANDWIDTH),d=d||a.Number.MAX_VALUE,c.attributes&&c.attributes.BANDWIDTH&&(e=c.attributes.BANDWIDTH),e=e||a.Number.MAX_VALUE,d-e},b.Hls.comparePlaylistResolution=function(b,c){var d,e;return b.attributes&&b.attributes.RESOLUTION&&b.attributes.RESOLUTION.width&&(d=b.attributes.RESOLUTION.width),d=d||a.Number.MAX_VALUE,c.attributes&&c.attributes.RESOLUTION&&c.attributes.RESOLUTION.width&&(e=c.attributes.RESOLUTION.width),e=e||a.Number.MAX_VALUE,d===e&&b.attributes.BANDWIDTH&&c.attributes.BANDWIDTH?b.attributes.BANDWIDTH-c.attributes.BANDWIDTH:d-e},g=b.Hls.resolveUrl=function(a,b){var d,e,f=c.querySelector("base"),g=c.querySelector("head"),h=c.createElement("a"),i=f;return f?d=f.href:i=g.appendChild(c.createElement("base")),i.href=a,h.href=b,e=h.href,f?f.href=d:g.removeChild(i),e}}(window,window.videojs,document),function(a,b){var c=function(){this.init=function(){var a={};this.on=function(b,c){a[b]||(a[b]=[]),a[b].push(c)},this.off=function(b,c){var d;return a[b]?(d=a[b].indexOf(c),a[b].splice(d,1),d>-1):!1},this.trigger=function(b){var c,d,e,f;if(c=a[b])for(f=Array.prototype.slice.call(arguments,1),e=c.length,d=0;e>d;++d)c[d].apply(this,f)},this.dispose=function(){a={}}}};c.prototype.pipe=function(a){this.on("data",function(b){a.push(b)})},a.Hls.Stream=c}(window.videojs),function(a){a.videojs=a.videojs||{},a.videojs.Hls=a.videojs.Hls||{};var b=a.videojs.Hls;b.FlvTag=function(a,c){var d,e=0,f=function(a,b){var c,d=a.position+b;d<a.bytes.byteLength||(c=new Uint8Array(2*d),c.set(a.bytes.subarray(0,a.position),0),a.bytes=c,a.view=new DataView(a.bytes.buffer))},g=b.FlvTag.widthBytes||new Uint8Array("width".length),h=b.FlvTag.heightBytes||new Uint8Array("height".length),i=b.FlvTag.videocodecidBytes||new Uint8Array("videocodecid".length);if(!b.FlvTag.widthBytes){for(d=0;d<"width".length;d++)g[d]="width".charCodeAt(d);for(d=0;d<"height".length;d++)h[d]="height".charCodeAt(d);for(d=0;d<"videocodecid".length;d++)i[d]="videocodecid".charCodeAt(d);b.FlvTag.widthBytes=g,b.FlvTag.heightBytes=h,b.FlvTag.videocodecidBytes=i}switch(this.keyFrame=!1,a){case b.FlvTag.VIDEO_TAG:this.length=16;break;case b.FlvTag.AUDIO_TAG:this.length=13,this.keyFrame=!0;break;case b.FlvTag.METADATA_TAG:this.length=29,this.keyFrame=!0;break;default:throw"Error Unknown TagType"}this.bytes=new Uint8Array(16384),this.view=new DataView(this.bytes.buffer),this.bytes[0]=a,this.position=this.length,this.keyFrame=c,this.pts=0,this.dts=0,this.writeBytes=function(a,b,c){var d,e=b||0;c=c||a.byteLength,d=e+c,f(this,c),this.bytes.set(a.subarray(e,d),this.position),this.position+=c,this.length=Math.max(this.length,this.position)},this.writeByte=function(a){f(this,1),this.bytes[this.position]=a,this.position++,this.length=Math.max(this.length,this.position)},this.writeShort=function(a){f(this,2),this.view.setUint16(this.position,a),this.position+=2,this.length=Math.max(this.length,this.position)},this.negIndex=function(a){return this.bytes[this.length-a]},this.nalUnitSize=function(){return 0===e?0:this.length-(e+4)},this.startNalUnit=function(){if(e>0)throw new Error("Attempted to create new NAL wihout closing the old one");e=this.length,this.length+=4,this.position=this.length},this.endNalUnit=function(a){var b,c;this.length===e+4?this.length-=4:e>0&&(b=e+4,c=this.length-b,this.position=e,this.view.setUint32(this.position,c),this.position=this.length,a&&a.push(this.bytes.subarray(b,b+c))),e=0},this.writeMetaDataDouble=function(a,b){var c;if(f(this,2+a.length+9),this.view.setUint16(this.position,a.length),this.position+=2,"width"===a)this.bytes.set(g,this.position),this.position+=5;else if("height"===a)this.bytes.set(h,this.position),this.position+=6;else if("videocodecid"===a)this.bytes.set(i,this.position),this.position+=12;else for(c=0;c<a.length;c++)this.bytes[this.position]=a.charCodeAt(c),this.position++;this.position++,this.view.setFloat64(this.position,b),this.position+=8,this.length=Math.max(this.length,this.position),++e},this.writeMetaDataBoolean=function(a,b){var c;for(f(this,2),this.view.setUint16(this.position,a.length),this.position+=2,c=0;c<a.length;c++)console.assert(a.charCodeAt(c)<255),f(this,1),this.bytes[this.position]=a.charCodeAt(c),this.position++;f(this,2),this.view.setUint8(this.position,1),this.position++,this.view.setUint8(this.position,b?1:0),this.position++,this.length=Math.max(this.length,this.position),++e},this.finalize=function(){var a,d;switch(this.bytes[0]){case b.FlvTag.VIDEO_TAG:this.bytes[11]=7|(this.keyFrame||c?16:32),this.bytes[12]=c?0:1,a=this.pts-this.dts,this.bytes[13]=(16711680&a)>>>16,this.bytes[14]=(65280&a)>>>8,this.bytes[15]=(255&a)>>>0;break;case b.FlvTag.AUDIO_TAG:this.bytes[11]=175,this.bytes[12]=c?0:1;break;case b.FlvTag.METADATA_TAG:this.position=11,this.view.setUint8(this.position,2),this.position++,this.view.setUint16(this.position,10),this.position+=2,this.bytes.set([111,110,77,101,116,97,68,97,116,97],this.position),this.position+=10,this.bytes[this.position]=8,this.position++,this.view.setUint32(this.position,e),this.position=this.length,this.bytes.set([0,0,9],this.position),this.position+=3,this.length=this.position}return d=this.length-11,this.bytes[1]=(16711680&d)>>>16,this.bytes[2]=(65280&d)>>>8,this.bytes[3]=(255&d)>>>0,this.bytes[4]=(16711680&this.dts)>>>16,this.bytes[5]=(65280&this.dts)>>>8,this.bytes[6]=(255&this.dts)>>>0,this.bytes[7]=(4278190080&this.dts)>>>24,this.bytes[8]=0,this.bytes[9]=0,this.bytes[10]=0,f(this,4),this.view.setUint32(this.length,this.length),this.length+=4,this.position+=4,this.bytes=this.bytes.subarray(0,this.length),this.frameTime=b.FlvTag.frameTime(this.bytes),console.assert(this.bytes.byteLength===this.length),this}},b.FlvTag.AUDIO_TAG=8,b.FlvTag.VIDEO_TAG=9,b.FlvTag.METADATA_TAG=18,b.FlvTag.isAudioFrame=function(a){return b.FlvTag.AUDIO_TAG===a[0]},b.FlvTag.isVideoFrame=function(a){return b.FlvTag.VIDEO_TAG===a[0]},b.FlvTag.isMetaData=function(a){return b.FlvTag.METADATA_TAG===a[0]},b.FlvTag.isKeyFrame=function(a){return b.FlvTag.isVideoFrame(a)?23===a[11]:b.FlvTag.isAudioFrame(a)?!0:b.FlvTag.isMetaData(a)?!0:!1},b.FlvTag.frameTime=function(a){var b=a[4]<<16;return b|=a[5]<<8,b|=a[6]<<0,b|=a[7]<<24},b.FlvTag.durationFromTags=function(a){if(a.length<2)return 0;var b,c=a[0],d=a[a.length-1];return b=d.pts-a[a.length-2].pts||1/24,d.pts-c.pts+b}}(this),function(a){a.videojs.Hls.ExpGolomb=function(a){var b=a.byteLength,c=0,d=0;this.length=function(){return 8*b},this.bitsAvailable=function(){return 8*b+d},this.loadWord=function(){var e=a.byteLength-b,f=new Uint8Array(4),g=Math.min(4,b);if(0===g)throw new Error("no bytes available");f.set(a.subarray(e,e+g)),c=new DataView(f.buffer).getUint32(0),d=8*g,b-=g},this.skipBits=function(a){var e;d>a?(c<<=a,d-=a):(a-=d,e=a/8,a-=8*e,b-=e,this.loadWord(),c<<=a,d-=a)},this.readBits=function(a){var e=Math.min(d,a),f=c>>>32-e;return console.assert(32>a,"Cannot read more than 32 bits at a time"),d-=e,d>0?c<<=e:b>0&&this.loadWord(),e=a-e,e>0?f<<e|this.readBits(e):f},this.skipLeadingZeros=function(){var a;for(a=0;d>a;++a)if(0!==(c&2147483648>>>a))return c<<=a,d-=a,a;return this.loadWord(),a+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var a=this.skipLeadingZeros();return this.readBits(a+1)-1},this.readExpGolomb=function(){var a=this.readUnsignedExpGolomb();return 1&a?1+a>>>1:-1*(a>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()}}(this),function(a){var b,c=a.videojs.Hls.ExpGolomb,d=a.videojs.Hls.FlvTag,e=function(){this.sps=[],this.pps=[],this.extraDataExists=function(){return this.sps.length>0},this.scaling_list=function(a,b){var c,d,e=8,f=8;for(c=0;a>c;++c)0!==f&&(d=b.readExpGolomb(),f=(e+d+256)%256),e=0===f?e:f},this.getSps0Rbsp=function(){for(var a=this.sps[0],b=1,c=1,d=0,e=a.byteLength-2,f=new Uint8Array(a.byteLength);e>b;)0===a[b]&&0===a[b+1]&&3===a[b+2]&&(f.set(a.subarray(c,b+1),d),d+=b+1-c,c=b+3),b++;return f.set(a.subarray(c),d),f.subarray(0,d+(a.byteLength-c))},this.metaDataTag=function(a){var b,e,f,g,h,i,j,k,l,m,n,o,p,q=new d(d.METADATA_TAG),r=0,s=0,t=0,u=0;if(q.dts=a,q.pts=a,b=new c(this.getSps0Rbsp()),e=b.readUnsignedByte(),b.skipBits(16),b.skipUnsignedExpGolomb(),(100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e)&&(f=b.readUnsignedExpGolomb(),3===f&&b.skipBits(1),b.skipUnsignedExpGolomb(),b.skipUnsignedExpGolomb(),b.skipBits(1),b.readBoolean()))for(g=3!==f?8:12,h=0;g>h;++h)b.readBoolean()&&(6>h?this.scaling_list(16,b):this.scaling_list(64,b));if(b.skipUnsignedExpGolomb(),i=b.readUnsignedExpGolomb(),0===i)b.readUnsignedExpGolomb();else if(1===i)for(b.skipBits(1),b.skipExpGolomb(),b.skipExpGolomb(),j=b.readUnsignedExpGolomb(),h=0;j>h;++h)b.skipExpGolomb();return b.skipUnsignedExpGolomb(),b.skipBits(1),k=b.readUnsignedExpGolomb(),l=b.readUnsignedExpGolomb(),m=b.readBits(1),0===m&&b.skipBits(1),b.skipBits(1),n=b.readBoolean(),n&&(r=b.readUnsignedExpGolomb(),s=b.readUnsignedExpGolomb(),t=b.readUnsignedExpGolomb(),u=b.readUnsignedExpGolomb()),o=16*(k+1)-2*r-2*s,p=(2-m)*(l+1)*16-2*t-2*u,q.writeMetaDataDouble("videocodecid",7),q.writeMetaDataDouble("width",o),q.writeMetaDataDouble("height",p),q},this.extraDataTag=function(a){var b,c=new d(d.VIDEO_TAG,!0);for(c.dts=a,c.pts=a,c.writeByte(1),c.writeByte(this.sps[0][1]),c.writeByte(this.sps[0][2]),c.writeByte(this.sps[0][3]),c.writeByte(255),c.writeByte(225),c.writeShort(this.sps[0].length),c.writeBytes(this.sps[0]),c.writeByte(this.pps.length),b=0;b<this.pps.length;++b)c.writeShort(this.pps[b].length),c.writeBytes(this.pps[b]);return c}};a.videojs.Hls.NALUnitType=b={unspecified:0,slice_layer_without_partitioning_rbsp_non_idr:1,slice_data_partition_a_layer_rbsp:2,slice_data_partition_b_layer_rbsp:3,slice_data_partition_c_layer_rbsp:4,slice_layer_without_partitioning_rbsp_idr:5,sei_rbsp:6,seq_parameter_set_rbsp:7,pic_parameter_set_rbsp:8,access_unit_delimiter_rbsp:9,end_of_seq_rbsp:10,end_of_stream_rbsp:11},a.videojs.Hls.H264Stream=function(){var a,c,f,g,h,i=new e,j=new e,k=-1;this.tags=[],this.setTimeStampOffset=function(a){f=a},this.setNextTimeStamp=function(b,d,e){a=b-f,c=d-f,e&&this.finishFrame()},this.finishFrame=function(){g&&(j.extraDataExists()&&(i=j,j=new e),(g.keyFrame||0===this.tags.length)&&(this.tags.push(i.metaDataTag(g.pts)),this.tags.push(i.extraDataTag(g.pts))),g.endNalUnit(),this.tags.push(g)),g=null,k=-1,h=0},this.writeBytes=function(e,f,i){var l,m,n,o;if(f=f||0,i=i||0,!(0>=i))switch(h){default:case 0:h=1;case 1:if(e[f]<=1&&(l=g?g.nalUnitSize():0,l>=1&&0===g.negIndex(1))){if(1===e[f]&&l>=2&&0===g.negIndex(2))return l>=3&&0===g.negIndex(3)?g.length-=3:g.length-=2,h=3,this.writeBytes(e,f+1,i-1);if(i>1&&0===e[f]&&1===e[f+1])return l>=2&&0===g.negIndex(2)?g.length-=2:g.length-=1,h=3,this.writeBytes(e,f+2,i-2);if(i>2&&0===e[f]&&0===e[f+1]&&1===e[f+2])return h=3,this.writeBytes(e,f+3,i-3)}h=2;case 2:for(m=f,n=m+i,o=n-3;o>f;)if(e[f+2]>1)f+=3;else if(0!==e[f+1])f+=2;else if(0!==e[f])f+=1;else{if(1===e[f+2])return f>m&&g.writeBytes(e,m,f-m),h=3,f+=3,this.writeBytes(e,f,n-f);if(n-f>=4&&0===e[f+2]&&1===e[f+3])return f>m&&g.writeBytes(e,m,f-m),h=3,f+=4,this.writeBytes(e,f,n-f);f+=3}return h=1,void(g&&g.writeBytes(e,m,i));case 3:if(g)switch(k){case b.seq_parameter_set_rbsp:g.endNalUnit(j.sps);break;case b.pic_parameter_set_rbsp:g.endNalUnit(j.pps);break;case b.slice_layer_without_partitioning_rbsp_idr:g.endNalUnit();break;default:g.endNalUnit()}return k=31&e[f],g&&(k===b.access_unit_delimiter_rbsp?this.finishFrame():k===b.slice_layer_without_partitioning_rbsp_idr&&(g.keyFrame=!0)),g||(g=new d(d.VIDEO_TAG),g.pts=a,g.dts=c),g.startNalUnit(),h=2,this.writeBytes(e,f,i)}}}}(this),function(a){var b=a.videojs.Hls.FlvTag,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3];a.videojs.Hls.AacStream=function(){var a,d,e,f,g,h,i,j,k,l,m,n,o,p;this.tags=[],this.setTimeStampOffset=function(a){d=a,g=a-1e3},this.setNextTimeStamp=function(b,c,g){a=b-d,f=c,g&&(e=0)},this.writeBytes=function(d,q,r){var s,t,u;for(q=q||0,r=r||0,r=r>f?f:r,f-=r,s=q+r;s>q;)switch(e){default:e=0;break;case 0:if(q>=s)return;if(255!==d[q])return console.assert(!1,"Error no ATDS header found"),q+=1,void(e=0);q+=1,e=1;break;case 1:if(q>=s)return;if(240!==(240&d[q]))return console.assert(!1,"Error no ATDS header found"),q+=1,void(e=0);h=!!(1&d[q]),q+=1,e=2;break;case 2:if(q>=s)return;i=((192&d[q])>>>6)+1,j=(60&d[q])>>>2,k=(1&d[q])<<2,q+=1,e=3;break;case 3:if(q>=s)return;k|=(192&d[q])>>>6,l=(3&d[q])<<11,q+=1,e=4;break;case 4:if(q>=s)return;l|=d[q]<<3,q+=1,e=5;break;case 5:if(q>=s)return;l|=(224&d[q])>>>5,l-=h?7:9,q+=1,e=6;break;case 6:if(q>=s)return;m=1024*((3&d[q])+1),n=1e3*m/c[j],t=i<<11|j<<7|k<<3,(t!==p||a-g>=1e3)&&(o=new b(b.METADATA_TAG),o.pts=a,o.dts=a,o.writeMetaDataDouble("audiocodecid",10),o.writeMetaDataBoolean("stereo",2===k),o.writeMetaDataDouble("audiosamplerate",c[j]),o.writeMetaDataDouble("audiosamplesize",16),this.tags.push(o),p=t,o=new b(b.AUDIO_TAG,!0),o.pts=a,o.dts=o.pts,o.view.setUint16(o.position,t),o.position+=2,o.length=Math.max(o.length,o.position),this.tags.push(o),g=a),q+=1,e=7;break;case 7:if(!h){if(2>s-q)return;q+=2}o=new b(b.AUDIO_TAG),o.pts=a,o.dts=a,e=8;break;case 8:for(;l;){if(q>=s)return;u=l>s-q?s-q:l,o.writeBytes(d,q,u),q+=u,l-=u}this.tags.push(o),e=0,a+=n}}}}(this),function(a,b,c){"use strict";var d,e=function(a,b,c){var d,e="";for(d=b;c>d;d++)e+="%"+("00"+a[d].toString(16)).slice(-2);return e},f=function(b,c,d){return a.decodeURIComponent(e(b,c,d))},g=function(b,c,d){return a.unescape(e(b,c,d))},h={TXXX:function(a){var b;if(3===a.data[0])for(b=1;b<a.data.length;b++)if(0===a.data[b]){a.description=f(a.data,1,b),a.value=f(a.data,b+1,a.data.length);break}},WXXX:function(a){var b;if(3===a.data[0])for(b=1;b<a.data.length;b++)if(0===a.data[b]){a.description=f(a.data,1,b),a.url=f(a.data,b+1,a.data.length);break}},PRIV:function(a){var b;for(b=0;b<a.data.length;b++)if(0===a.data[b]){a.owner=g(a.data,0,b);break}a.privateData=a.data.subarray(b+1)}};d=function(a){var c,e={debug:!(!a||!a.debug),descriptor:a&&a.descriptor},f=0,g=[],i=0;if(d.prototype.init.call(this),this.dispatchType=b.Hls.SegmentParser.STREAM_TYPES.metadata.toString(16),e.descriptor)for(c=0;c<e.descriptor.length;c++)this.dispatchType+=("00"+e.descriptor[c].toString(16)).slice(-2);this.push=function(a){var c,d,j,k,l;if(0===g.length&&(a.data.length<10||a.data[0]!=="I".charCodeAt(0)||a.data[1]!=="D".charCodeAt(0)||a.data[2]!=="3".charCodeAt(0)))return void(e.debug&&b.log("Skipping unrecognized metadata packet"));if(g.push(a),i+=a.data.byteLength,1===g.length&&(f=a.data[6]<<21|a.data[7]<<14|a.data[8]<<7|a.data[9],f+=10),!(f>i)){for(c={data:new Uint8Array(f),frames:[],pts:g[0].pts,dts:g[0].dts},l=0;f>l;)c.data.set(g[0].data,l),l+=g[0].data.byteLength,i-=g[0].data.byteLength,g.shift();d=10,64&c.data[5]&&(d+=4,d+=c.data[10]<<24|c.data[11]<<16|c.data[12]<<8|c.data[13],f-=c.data[16]<<24|c.data[17]<<16|c.data[18]<<8|c.data[19]),this.timestampOffset&&(c.pts-=this.timestampOffset,c.dts-=this.timestampOffset);do{if(j=c.data[d+4]<<24|c.data[d+5]<<16|c.data[d+6]<<8|c.data[d+7],1>j)return b.log("Malformed ID3 frame encountered. Skipping metadata parsing.");k={id:String.fromCharCode(c.data[d],c.data[d+1],c.data[d+2],c.data[d+3]),data:c.data.subarray(d+10,d+j+10)},h[k.id]&&h[k.id](k),c.frames.push(k),d+=10,d+=j}while(f>d);this.trigger("data",c)}}},d.prototype=new b.Hls.Stream,b.Hls.MetadataStream=d}(window,window.videojs),function(a){var b,c,d=a.videojs,e=d.Hls.FlvTag,f=d.Hls.H264Stream,g=d.Hls.AacStream,h=d.Hls.MetadataStream;d.Hls.SegmentParser=function(){var a,i,j=this,k=new Uint8Array(b),l=0,m=new f,n=new g,o=!1,p=!1;j.stream={programMapTable:{}},j.metadataStream=new h,j.getFlvHeader=function(a,b,c){var d,f,g,h=new Uint8Array(9),i=new DataView(h.buffer);return a=a||0,b=void 0===b?!0:b,c=void 0===c?!0:c,i.setUint8(0,70),i.setUint8(1,76),i.setUint8(2,86),i.setUint8(3,1),i.setUint8(4,(b?4:0)|(c?1:0)),i.setUint32(5,h.byteLength),0>=a?(f=new Uint8Array(h.byteLength+4),f.set(h),f.set([0,0,0,0],h.byteLength),f):(d=new e(e.METADATA_TAG),d.pts=d.dts=0,d.writeMetaDataDouble("duration",a),g=d.finalize().length,f=new Uint8Array(h.byteLength+g),f.set(h),f.set(i.byteLength,g),f)},j.flushTags=function(){m.finishFrame()},j.tagsAvailable=function(){return m.tags.length+n.tags.length},j.getNextTag=function(){var a;return a=m.tags.length?n.tags.length&&n.tags[0].dts<m.tags[0].dts?n.tags.shift():m.tags.shift():n.tags.shift(),a.finalize()},j.parseSegmentBinaryData=function(c){var e,f=0;if(l>0){if(c.byteLength+l<b)return d.log("data.length + streamBuffer.length < MP2T_PACKET_LENGTH ??"),void k.readBytes(c,c.length,k.length);e=c.subarray(0,b-l),k.set(e,l),a(k),k=new Uint8Array(b),l=0}for(;;){for(;f<c.byteLength&&71!==c[f];)f++;if(c.byteLength-f<b)return void(c.byteLength-f>0&&(k.set(c.subarray(f),l),l+=c.byteLength-f));a(c.subarray(f,f+b))?f+=b:(d.log("error parsing m2ts packet, attempting to re-align"),f++)}},a=function(a){var e,f,g,h,k,l,q,r,s,t,u,v,w,x,y,z=0,A=z+b,B=!!(64&a[z+1]),C=(31&a[z+1])<<8|a[z+2],D=(48&a[z+3])>>>4;if(z+=4,D>1&&(z+=a[z]+1),0===C){if(B&&(z+=1+a[z]),e=a[z],0!==e&&d.log("the table_id of the PAT should be 0x00 but was"+e.toString(16)),f=!!(1&a[z+5])){if(g=(15&a[z+1])<<8|a[z+2],z+=8,(g-5-4)/4!==1)throw new Error("TS has more that 1 program");j.stream.pmtPid=(31&a[z+2])<<8|a[z+3]}}else if(C===j.stream.programMapTable[c.h264]||C===j.stream.programMapTable[c.adts]||C===j.stream.programMapTable[c.metadata]){if(B){if(0!==a[z+0]||0!==a[z+1]||1!==a[z+2])throw new Error("PES did not begin with start code");h=a[z+4]<<8|a[z+5],k=0!==(4&a[z+6]),l=a[z+7],q=a[z+8],z+=9,192&l&&(r=(14&a[z+0])<<28|(255&a[z+1])<<21|(254&a[z+2])<<13|(255&a[z+3])<<6|(254&a[z+4])>>>2,r/=45,s=r,64&l&&(s=(14&a[z+5])<<28|(255&a[z+6])<<21|(254&a[z+7])<<13|(255&a[z+8])<<6|(254&a[z+9])>>>2,s/=45)),z+=q,j.metadataStream.timestampOffset||(j.metadataStream.timestampOffset=r),C===j.stream.programMapTable[c.h264]?(o||(o=!0,void 0===i&&(i=r),m.setTimeStampOffset(i)),m.setNextTimeStamp(r,s,k)):C===j.stream.programMapTable[c.adts]&&(p||(p=!0,void 0===i&&(i=r),n.setTimeStampOffset(i)),n.setNextTimeStamp(r,h,k))}C===j.stream.programMapTable[c.adts]?n.writeBytes(a,z,A-z):C===j.stream.programMapTable[c.h264]?m.writeBytes(a,z,A-z):C===j.stream.programMapTable[c.metadata]&&j.metadataStream.push({pts:r,dts:s,data:a.subarray(z)})}else if(j.stream.pmtPid===C){if(B&&(z+=1+a[z]),2!==a[z]&&d.log("The table_id of a PMT should be 0x02 but was "+a[z].toString(16)),t=!!(1&a[z+5]))for(j.stream.programMapTable={},v=(15&a[z+1])<<8|a[z+2],u=(15&a[z+10])<<8|a[z+11],v-=u,v-=13,z+=12+u;v>0;){if(w=a[z+0],x=(31&a[z+1])<<8|a[z+2],w===c.h264&&j.stream.programMapTable[w]&&j.stream.programMapTable[w]!==x)throw new Error("Program has more than 1 video stream");if(w===c.adts&&j.stream.programMapTable[w]&&j.stream.programMapTable[w]!==x)throw new Error("Program has more than 1 audio Stream");j.stream.programMapTable[w]=x,y=(15&a[z+3])<<8|a[z+4],w===c.metadata&&(j.metadataStream.descriptor=new Uint8Array(a.subarray(z+5,z+5+y))),z+=5+y,v-=5+y}}else 17===C||8191===C||d.log("Unknown PID parsing TS packet: "+C);return!0},j.getTags=function(){return m.tags},j.stats={h264Tags:function(){return m.tags.length},aacTags:function(){return n.tags.length}}},d.Hls.SegmentParser.MP2T_PACKET_LENGTH=b=188,d.Hls.SegmentParser.STREAM_TYPES=c={h264:27,adts:15,metadata:21}}(window),function(a,b,c,d,e){var f,g,h,i=function(){},j=function(){var a="[^=]*",b='"[^"]*"|[^,]*',c="(?:"+a+")=(?:"+b+")";return new RegExp("(?:^|,)("+c+")")}(),k=function(a){for(var b,c=a.split(j),d=c.length,e={};d--;)""!==c[d]&&(b=/([^=]*)=(.*)/.exec(c[d]).slice(1),b[0]=b[0].replace(/^\s+|\s+$/g,""),b[1]=b[1].replace(/^\s+|\s+$/g,""),b[1]=b[1].replace(/^['"](.*)['"]$/g,"$1"),e[b[0]]=b[1]);return e},l=a.Hls.Stream;f=function(){var a="";f.prototype.init.call(this),this.push=function(b){var c;for(a+=b,c=a.indexOf("\n");c>-1;c=a.indexOf("\n"))this.trigger("data",a.substring(0,c)),a=a.substring(c+1)}},f.prototype=new l,g=function(){g.prototype.init.call(this)},g.prototype=new l,g.prototype.push=function(a){var c,d;if(0!==a.length)return"#"!==a[0]?void this.trigger("data",{type:"uri",uri:a}):0!==a.indexOf("#EXT")?void this.trigger("data",{type:"comment",text:a.slice(1)}):(a=a.replace("\r",""),(c=/^#EXTM3U/.exec(a))?void this.trigger("data",{type:"tag",tagType:"m3u"}):(c=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(a))?(d={type:"tag",tagType:"inf"},c[1]&&(d.duration=parseFloat(c[1])),c[2]&&(d.title=c[2]),void this.trigger("data",d)):(c=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(a))?(d={
type:"tag",tagType:"targetduration"},c[1]&&(d.duration=b(c[1],10)),void this.trigger("data",d)):(c=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(a))?(d={type:"tag",tagType:"totalduration"},c[1]&&(d.duration=b(c[1],10)),void this.trigger("data",d)):(c=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(a))?(d={type:"tag",tagType:"version"},c[1]&&(d.version=b(c[1],10)),void this.trigger("data",d)):(c=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(a))?(d={type:"tag",tagType:"media-sequence"},c[1]&&(d.number=b(c[1],10)),void this.trigger("data",d)):(c=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(a))?(d={type:"tag",tagType:"playlist-type"},c[1]&&(d.playlistType=c[1]),void this.trigger("data",d)):(c=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(a))?(d={type:"tag",tagType:"byterange"},c[1]&&(d.length=b(c[1],10)),c[2]&&(d.offset=b(c[2],10)),void this.trigger("data",d)):(c=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(a))?(d={type:"tag",tagType:"allow-cache"},c[1]&&(d.allowed=!/NO/.test(c[1])),void this.trigger("data",d)):(c=/^#EXT-X-STREAM-INF:?(.*)$/.exec(a))?(d={type:"tag",tagType:"stream-inf"},c[1]&&(d.attributes=k(c[1]),d.attributes.RESOLUTION&&!function(){var a=d.attributes.RESOLUTION.split("x"),c={};a[0]&&(c.width=b(a[0],10)),a[1]&&(c.height=b(a[1],10)),d.attributes.RESOLUTION=c}(),d.attributes.BANDWIDTH&&(d.attributes.BANDWIDTH=b(d.attributes.BANDWIDTH,10)),d.attributes["PROGRAM-ID"]&&(d.attributes["PROGRAM-ID"]=b(d.attributes["PROGRAM-ID"],10))),void this.trigger("data",d)):(c=/^#EXT-X-ENDLIST/.exec(a))?void this.trigger("data",{type:"tag",tagType:"endlist"}):(c=/^#EXT-X-DISCONTINUITY/.exec(a))?void this.trigger("data",{type:"tag",tagType:"discontinuity"}):(c=/^#EXT-X-KEY:?(.*)$/.exec(a))?(d={type:"tag",tagType:"key"},c[1]&&(d.attributes=k(c[1]),d.attributes.IV&&("0x"===d.attributes.IV.substring(0,2)&&(d.attributes.IV=d.attributes.IV.substring(2)),d.attributes.IV=d.attributes.IV.match(/.{8}/g),d.attributes.IV[0]=b(d.attributes.IV[0],16),d.attributes.IV[1]=b(d.attributes.IV[1],16),d.attributes.IV[2]=b(d.attributes.IV[2],16),d.attributes.IV[3]=b(d.attributes.IV[3],16),d.attributes.IV=new Uint32Array(d.attributes.IV))),void this.trigger("data",d)):void this.trigger("data",{type:"tag",data:a.slice(4,a.length)}))},h=function(){var a,b=this,j=[],k={};h.prototype.init.call(this),this.lineStream=new f,this.parseStream=new g,this.lineStream.pipe(this.parseStream),this.manifest={allowCache:!0},this.parseStream.on("data",function(f){({tag:function(){(({"allow-cache":function(){this.manifest.allowCache=f.allowed,"allowed"in f||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var a={};"length"in f&&(k.byterange=a,a.length=f.length,"offset"in f||(this.trigger("info",{message:"defaulting offset to zero"}),f.offset=0)),"offset"in f&&(k.byterange=a,a.offset=f.offset)},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),f.duration>=0&&(k.duration=f.duration),this.manifest.segments=j},key:function(){return f.attributes?"NONE"===f.attributes.METHOD?void(a=null):f.attributes.URI?(f.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),a={method:f.attributes.METHOD||"AES-128",uri:f.attributes.URI},void(f.attributes.IV!==e&&(a.iv=f.attributes.IV))):void this.trigger("warn",{message:"ignoring key declaration without URI"}):void this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){return c(f.number)?void(this.manifest.mediaSequence=f.number):void this.trigger("warn",{message:"ignoring invalid media sequence: "+f.number})},"playlist-type":function(){return/VOD|EVENT/.test(f.playlistType)?void(this.manifest.playlistType=f.playlistType):void this.trigger("warn",{message:"ignoring unknown playlist type: "+f.playlist})},"stream-inf":function(){return this.manifest.playlists=j,f.attributes?(k.attributes||(k.attributes={}),void(k.attributes=d(k.attributes,f.attributes))):void this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},discontinuity:function(){k.discontinuity=!0},targetduration:function(){return!c(f.duration)||f.duration<0?void this.trigger("warn",{message:"ignoring invalid target duration: "+f.duration}):void(this.manifest.targetDuration=f.duration)},totalduration:function(){return!c(f.duration)||f.duration<0?void this.trigger("warn",{message:"ignoring invalid total duration: "+f.duration}):void(this.manifest.totalDuration=f.duration)}})[f.tagType]||i).call(b)},uri:function(){k.uri=f.uri,j.push(k),!this.manifest.targetDuration||"duration"in k||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),k.duration=this.manifest.targetDuration),a&&(k.key=a),k={}},comment:function(){}})[f.type].call(b)})},h.prototype=new l,h.prototype.push=function(a){this.lineStream.push(a)},h.prototype.end=function(){this.lineStream.push("\n")},window.videojs.m3u8={LineStream:f,ParseStream:g,Parser:h}}(window.videojs,window.parseInt,window.isFinite,window.videojs.util.mergeOptions),function(a){a.Hls.xhr=function(b,c){var d,e,f={method:"GET",timeout:45e3};return"function"!=typeof c&&(c=function(){}),"object"==typeof b&&(f=a.util.mergeOptions(f,b),b=f.url),d=new window.XMLHttpRequest,d.open(f.method,b),d.url=b,d.requestTime=(new Date).getTime(),f.responseType&&(d.responseType=f.responseType),f.withCredentials&&(d.withCredentials=!0),f.timeout&&(e=window.setTimeout(function(){4!==d.readyState&&(d.timedout=!0,d.abort())},f.timeout)),d.onreadystatechange=function(){return 4===this.readyState?(window.clearTimeout(e),d.timedout?c.call(this,"timeout",b):this.status>=400||0===this.status?c.call(this,!0,b):(this.response&&(this.responseTime=(new Date).getTime(),this.roundTripTime=this.responseTime-this.requestTime,this.bytesReceived=this.response.byteLength||this.response.length,this.bandwidth=Math.floor(this.bytesReceived/this.roundTripTime*8*1e3)),c.call(this,!1,b))):void 0},d.send(null),d}}(window.videojs),function(a,b){"use strict";var c=b.Hls.resolveUrl,d=b.Hls.xhr,e=function(a,c){var d,e,f=!1,g=b.util.mergeOptions(a,{});for(d=a.playlists.length;d--;)if(e=g.playlists[d],e.uri===c.uri){if(e.segments&&c.segments&&e.segments.length===c.segments.length&&e.mediaSequence===c.mediaSequence)continue;g.playlists[d]=b.util.mergeOptions(e,c),g.playlists[c.uri]=g.playlists[d],f=!0}return f?g:null},f=function(g,h){var i,j,k,l,m=this,n=function(c,d,f){var g,h,i;return m.setBandwidth(l||d),l=null,c?(m.error={status:d.status,message:"HLS playlist request error at URL: "+f,responseText:d.responseText,code:d.status>=500?4:2},m.trigger("error")):(m.state="HAVE_METADATA",g=new b.m3u8.Parser,g.push(d.responseText),g.end(),g.manifest.uri=f,i=e(m.master,g.manifest),h=1e3*(g.manifest.targetDuration||10),i?(m.master=i,j=m.master.playlists[f]):h/=2,m.media().endList||(k=a.setTimeout(function(){m.trigger("mediaupdatetimeout")},h)),void m.trigger("loadedplaylist"))};if(f.prototype.init.call(this),!g)throw new Error("A non-empty playlist URL is required");m.state="HAVE_NOTHING",i=this.dispose,m.dispose=function(){l&&(l.onreadystatechange=null,l.abort(),l=null),a.clearTimeout(k),i.call(this)},m.media=function(a){var b=!1;if(!a)return j;if("HAVE_NOTHING"===m.state||"HAVE_MASTER"===m.state)throw new Error("Cannot switch media playlist from "+m.state);if("string"==typeof a){if(!m.master.playlists[a])throw new Error("Unknown playlist URI: "+a);a=m.master.playlists[a]}if(b=a.uri!==j.uri,m.master.playlists[a.uri].endList)return l&&(l.onreadystatechange=null,l.abort(),l=null),m.state="HAVE_METADATA",j=a,void(b&&m.trigger("mediachange"));if(b){if(m.state="SWITCHING_MEDIA",l){if(c(m.master.uri,a.uri)===l.url)return;l.onreadystatechange=null,l.abort(),l=null}l=d({url:c(m.master.uri,a.uri),withCredentials:h},function(b){n(b,this,a.uri),m.trigger("mediachange")})}},m.setBandwidth=function(a){m.bandwidth=a.bandwidth},m.on("mediaupdatetimeout",function(){"HAVE_METADATA"===m.state&&(m.state="HAVE_CURRENT_METADATA",l=d({url:c(m.master.uri,m.media().uri),withCredentials:h},function(a){n(a,this,m.media().uri)}))}),d({url:g,withCredentials:h},function(e){var f,i;if(e)return m.error={status:this.status,message:"HLS playlist request error at URL: "+g,responseText:this.responseText,code:2},m.trigger("error");if(f=new b.m3u8.Parser,f.push(this.responseText),f.end(),m.state="HAVE_MASTER",f.manifest.uri=g,f.manifest.playlists){for(m.master=f.manifest,i=m.master.playlists.length;i--;)m.master.playlists[m.master.playlists[i].uri]=m.master.playlists[i];return l=d({url:c(g,f.manifest.playlists[0].uri),withCredentials:h},function(a){n(a,this,f.manifest.playlists[0].uri),a||m.trigger("loadedmetadata")}),m.trigger("loadedplaylist")}return m.master={uri:a.location.href,playlists:[{uri:g}]},m.master.playlists[g]=m.master.playlists[0],n(null,this,g),m.trigger("loadedmetadata")})};f.prototype=new b.Hls.Stream,b.Hls.PlaylistLoader=f}(window,window.videojs),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){(function(b){b.window.pkcs7={unpad:a("./unpad")}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./unpad":2}],2:[function(a,b,c){"use strict";b.exports=function(a){return a.subarray(0,a.byteLength-a[a.byteLength-1])}},{}]},{},[1]),function(a,b,c){"use strict";var d,e,f,g,h;h=function(a){return a<<24|(65280&a)<<8|(16711680&a)>>8|a>>>24},d=function(a){this._precompute();var b,c,d,e,f,g=this._tables[0][4],h=this._tables[1],i=a.length,j=1;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size");for(e=a.slice(0),f=[],this._key=[e,f],b=i;4*i+28>b;b++)d=e[b-1],(b%i===0||8===i&&b%i===4)&&(d=g[d>>>24]<<24^g[d>>16&255]<<16^g[d>>8&255]<<8^g[255&d],b%i===0&&(d=d<<8^d>>>24^j<<24,j=j<<1^283*(j>>7))),e[b]=e[b-i]^d;for(c=0;b;c++,b--)d=e[3&c?b:b-4],4>=b||4>c?f[c]=d:f[c]=h[0][g[d>>>24]]^h[1][g[d>>16&255]]^h[2][g[d>>8&255]]^h[3][g[255&d]]},d.prototype={_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var a,b,c,d,e,f,g,h,i,j=this._tables[0],k=this._tables[1],l=j[4],m=k[4],n=[],o=[];for(a=0;256>a;a++)o[(n[a]=a<<1^283*(a>>7))^a]=a;for(b=c=0;!l[b];b^=d||1,c=o[c]||1)for(g=c^c<<1^c<<2^c<<3^c<<4,g=g>>8^255&g^99,l[b]=g,m[g]=b,f=n[e=n[d=n[b]]],i=16843009*f^65537*e^257*d^16843008*b,h=257*n[g]^16843008*g,a=0;4>a;a++)j[a][b]=h=h<<24^h>>>8,k[a][g]=i=i<<24^i>>>8;for(a=0;5>a;a++)j[a]=j[a].slice(0),k[a]=k[a].slice(0)},decrypt:function(a,b,c,d,e,f){var g,h,i,j,k=this._key[1],l=a^k[0],m=d^k[1],n=c^k[2],o=b^k[3],p=k.length/4-2,q=4,r=this._tables[1],s=r[0],t=r[1],u=r[2],v=r[3],w=r[4];for(j=0;p>j;j++)g=s[l>>>24]^t[m>>16&255]^u[n>>8&255]^v[255&o]^k[q],h=s[m>>>24]^t[n>>16&255]^u[o>>8&255]^v[255&l]^k[q+1],i=s[n>>>24]^t[o>>16&255]^u[l>>8&255]^v[255&m]^k[q+2],o=s[o>>>24]^t[l>>16&255]^u[m>>8&255]^v[255&n]^k[q+3],q+=4,l=g,m=h,n=i;for(j=0;4>j;j++)e[(3&-j)+f]=w[l>>>24]<<24^w[m>>16&255]<<16^w[n>>8&255]<<8^w[255&o]^k[q++],g=l,l=m,m=n,n=o,o=g}},g=function(a,b,c){var e,f,g,i,j,k,l,m,n,o=new Int32Array(a.buffer,a.byteOffset,a.byteLength>>2),p=new d(Array.prototype.slice.call(b)),q=new Uint8Array(a.byteLength),r=new Int32Array(q.buffer);for(e=c[0],f=c[1],g=c[2],i=c[3],n=0;n<o.length;n+=4)j=h(o[n]),k=h(o[n+1]),l=h(o[n+2]),m=h(o[n+3]),p.decrypt(j,k,l,m,r,n),r[n]=h(r[n]^e),r[n+1]=h(r[n+1]^f),r[n+2]=h(r[n+2]^g),r[n+3]=h(r[n+3]^i),e=j,f=k,g=l,i=m;return q},e=function(){this.jobs=[],this.delay=1,this.timeout_=null},e.prototype=new b.Hls.Stream,e.prototype.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(b.bind(this,this.processJob_),this.delay):this.timeout_=null},e.prototype.push=function(a){this.jobs.push(a),this.timeout_||(this.timeout_=setTimeout(b.bind(this,this.processJob_),this.delay))},f=function(a,b,d,g){var i=f.STEP,j=new Int32Array(a.buffer),k=new Uint8Array(a.byteLength),l=0;for(this.asyncStream_=new e,this.asyncStream_.push(this.decryptChunk_(j.subarray(l,l+i),b,d,k,l)),l=i;l<j.length;l+=i)d=new Uint32Array([h(j[l-4]),h(j[l-3]),h(j[l-2]),h(j[l-1])]),this.asyncStream_.push(this.decryptChunk_(j.subarray(l,l+i),b,d,k));this.asyncStream_.push(function(){g(null,c(k))})},f.prototype=new b.Hls.Stream,f.prototype.decryptChunk_=function(a,b,c,d){return function(){var e=g(a,b,c);d.set(e,a.byteOffset)}},f.STEP=32e3,b.Hls.decrypt=g,b.Hls.Decrypter=f,b.Hls.AsyncStream=e}(window,window.videojs,window.pkcs7.unpad);